
<div id='nodeSection1'>Execution plans and statistics</div>
<p><span class=rvts12><br></span></p>
<p><span class=rvts64>SET</span><span class=rvts61> </span><span class=rvts64>SHOWPLAN_TEXT</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>ON</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- show execution plan instead of the query result (reset it to OFF after the query)</span></p>
<p><span class=rvts64>SET</span><span class=rvts61> </span><span class=rvts64>SHOWPLAN_ALL</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>ON</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- show the execution plan inluding estimated resource requirements</span></p>
<p><span class=rvts64>SET</span><span class=rvts61> </span><span class=rvts64>SHOWPLAN_XML</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>ON</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- show the execution plan as an XML document</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>SET</span><span class=rvts61> </span><span class=rvts64>STATISTICS</span><span class=rvts61> </span><span class=rvts64>XML</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>ON</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- profiling: show runtime information as XML (the query is executed as well)</span></p>
<p><span class=rvts64>SET</span><span class=rvts61> </span><span class=rvts64>STATISTICS</span><span class=rvts61> </span><span class=rvts64>IO</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>ON</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- show IO statistics as message (in parallel to the query result)</span></p>
<p><span class=rvts64>SET</span><span class=rvts61> </span><span class=rvts64>STATISTICS</span><span class=rvts61> </span><span class=rvts64>TIME</span><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>ON</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- show runtime duration information</span></p>
<p><span class=rvts64>SET</span><span class=rvts61> </span><span class=rvts64>STATISTICS</span><span class=rvts61> </span><span class=rvts64>PROFILE</span><span class=rvts61> </span><span class=rvts64>ON</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- show the execution plan with additional profiling information (per step)</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts8><br></span></p>
<div id='nodeSection2'>Optimiser hints</div>
<p><span class=rvts64><br></span></p>
<p><span class=rvts64>SELECT</span><span class=rvts61> </span><span class=rvts63>*</span><span class=rvts61> </span><span class=rvts64>FROM</span><span class=rvts61> my_table </span><span class=rvts64>WITH</span><span class=rvts63>(</span><span class=rvts64>INDEX</span><span class=rvts63>(</span><span class=rvts61>my_index</span><span class=rvts63>))</span><span class=rvts61> </span><span class=rvts63>...;</span><span class=rvts61>&nbsp;&nbsp; </span><span class=rvts62>-- enforce the use of the specified index (and no other) for the particular table</span></p>
<p><span class=rvts64>SELECT</span><span class=rvts61> </span><span class=rvts63>*</span><span class=rvts61> </span><span class=rvts64>FROM</span><span class=rvts61> my_table </span><span class=rvts64>WITH</span><span class=rvts63>(</span><span class=rvts64>INDEX</span><span class=rvts63>(</span><span class=rvts61>0</span><span class=rvts63>))</span><span class=rvts61> </span><span class=rvts63>...;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- do not use any non-clustered index (may still utilise the clustered index)</span></p>
<p><span class=rvts64>SELECT</span><span class=rvts61> </span><span class=rvts63>*</span><span class=rvts61> </span><span class=rvts64>FROM</span><span class=rvts61> my_view </span><span class=rvts64>WITH</span><span class=rvts63>(</span><span class=rvts64>NOEXPAND</span><span class=rvts63>)</span><span class=rvts61> </span><span class=rvts63>...;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- use the view as it is, do not go down to the source tables' indices</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>SELECT</span><span class=rvts61> </span><span class=rvts63>*</span><span class=rvts61> </span><span class=rvts64>FROM</span><span class=rvts61> tab1 </span><span class=rvts63>JOIN</span><span class=rvts61> tab2 </span><span class=rvts64>OPTION</span><span class=rvts63>(</span><span class=rvts64>FORCE</span><span class=rvts61> </span><span class=rvts64>ORDER</span><span class=rvts63>);</span><span class=rvts61>&nbsp;&nbsp; </span><span class=rvts62>-- join tables reversed to how they appear in the SELECT statement</span></p>
<p><span class=rvts64>SELECT</span><span class=rvts61> </span><span class=rvts63>*</span><span class=rvts61> </span><span class=rvts64>FROM</span><span class=rvts61> tab1 </span><span class=rvts63>JOIN</span><span class=rvts61> tab2 </span><span class=rvts64>OPTION</span><span class=rvts63>(</span><span class=rvts64>LOOP</span><span class=rvts63>);</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- build the full cartesian product and elimitate unsuitable combinations afterwards</span></p>
<p><span class=rvts64>SELECT</span><span class=rvts61> </span><span class=rvts63>*</span><span class=rvts61> </span><span class=rvts64>FROM</span><span class=rvts61> tab1 </span><span class=rvts63>JOIN</span><span class=rvts61> tab2 </span><span class=rvts64>OPTION</span><span class=rvts63>(</span><span class=rvts64>HASH</span><span class=rvts63>);</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- build a temporary list of hash buckets and compare the other table against it</span></p>
<p><span class=rvts64>SELECT</span><span class=rvts61> </span><span class=rvts63>*</span><span class=rvts61> </span><span class=rvts64>FROM</span><span class=rvts61> tab1 </span><span class=rvts63>JOIN</span><span class=rvts61> tab2 </span><span class=rvts64>OPTION</span><span class=rvts63>(</span><span class=rvts64>MERGE</span><span class=rvts63>);</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- merge tables which are already sorted by the same criteria</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>SELECT</span><span class=rvts61> </span><span class=rvts63>*</span><span class=rvts61> </span><span class=rvts64>FROM</span><span class=rvts61> tab1 </span><span class=rvts63>{</span><span class=rvts64>LOOP</span><span class=rvts63>|</span><span class=rvts64>HASH</span><span class=rvts63>|</span><span class=rvts64>MERGE</span><span class=rvts63>}</span><span class=rvts61> </span><span class=rvts63>JOIN</span><span class=rvts61> tab2</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- the merge hint can be written inline as well</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>SELECT</span><span class=rvts61> </span><span class=rvts63>*</span><span class=rvts61> </span><span class=rvts64>FROM</span><span class=rvts61> my_table </span><span class=rvts64>OPTION</span><span class=rvts63>(</span><span class=rvts64>FAST</span><span class=rvts61> 10</span><span class=rvts63>);</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- optimise the query for a fast retrieval of the first 10 records (the rest may take longer)</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>DECLARE</span><span class=rvts61> @value </span><span class=rvts64>INT</span><span class=rvts61> </span><span class=rvts63>=</span><span class=rvts61> 0</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- optimize the query to work best for the given parameter value(s)</span></p>
<p><span class=rvts64>SELECT</span><span class=rvts61> </span><span class=rvts63>*</span><span class=rvts61> </span><span class=rvts64>from</span><span class=rvts61> my_table </span><span class=rvts64>WHERE</span><span class=rvts61> col1 </span><span class=rvts63>=</span><span class=rvts61> @value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- use OPTIMIZE FOR UNKOWN to base the decision on statistical data </span></p>
<p><span class=rvts64>OPTION</span><span class=rvts63>(</span><span class=rvts61>OPTIMIZE </span><span class=rvts64>FOR </span><span class=rvts63>(</span><span class=rvts61>@value</span><span class=rvts63>=</span><span class=rvts61>100</span><span class=rvts63>));</span></p>
<p><span class=rvts63><br></span></p>
<p><br></p>
<p><br></p>

