
<div id='nodeSection1'>Maintaining tables</div>
<p><span class=rvts12><br></span></p>
<p><span class=rvts64>CREATE</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- create a new table</span></p>
<p><span class=rvts63>(</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; col1 </span><span class=rvts64>INT</span><span class=rvts61> </span><span class=rvts63>NOT</span><span class=rvts61> </span><span class=rvts63>NULL,</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- NULL or NOT NULL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; col2 </span><span class=rvts64>INT</span><span class=rvts61> </span><span class=rvts64>IDENTITY (</span><span class=rvts61>1000,1)</span><span class=rvts63>,</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- populate this field with an auto-incremented sequence (optional parameters: start value and increment)</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; col3 </span><span class=rvts64>INT</span><span class=rvts61> </span><span class=rvts64>DEFAULT</span><span class=rvts61> 100</span><span class=rvts63>,</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- default value when inserting new records</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; col4 </span><span class=rvts64>VARBINARY</span><span class=rvts63>(</span><span class=rvts67>MAX</span><span class=rvts63>)</span><span class=rvts61> </span><span class=rvts64>FILESTREAM</span><span class=rvts61> </span><span class=rvts63>NULL</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- content is stored as separate files in the file system</span></p>
<p><span class=rvts63>);</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>CREATE</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- create a table with column-level constraints</span></p>
<p><span class=rvts63>(</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; col1 </span><span class=rvts64>INT</span><span class=rvts61> </span><span class=rvts64>PRIMARY</span><span class=rvts61> </span><span class=rvts64>KEY</span><span class=rvts63>,</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- primary key with only one col</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; col2 </span><span class=rvts64>INT</span><span class=rvts61> </span><span class=rvts64>UNIQUE</span><span class=rvts63>,</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- value must be unique</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; col3 </span><span class=rvts64>INT</span><span class=rvts61> </span><span class=rvts64>CHECK</span><span class=rvts63>(</span><span class=rvts61>0 </span><span class=rvts63>&lt;</span><span class=rvts61> col3</span><span class=rvts63>),</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- expression must evaluate to true</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; col4 </span><span class=rvts64>INT</span><span class=rvts61> </span><span class=rvts64>REFERENCES</span><span class=rvts61> my_parent_table</span><span class=rvts63>(</span><span class=rvts61>col1</span><span class=rvts63>)</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- foreign key</span></p>
<p><span class=rvts63>);</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>CREATE</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table_3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- create a table with table-level constraints</span></p>
<p><span class=rvts63>(</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; col1 </span><span class=rvts64>INT</span><span class=rvts63>,</span><span class=rvts61> col2 </span><span class=rvts64>INT</span><span class=rvts63>,</span><span class=rvts61> col3 </span><span class=rvts64>INT</span><span class=rvts63>,</span><span class=rvts61> col4 </span><span class=rvts64>INT</span><span class=rvts63>,</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>CONSTRAINT</span><span class=rvts61> PK_mt_3&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>PRIMARY</span><span class=rvts61> </span><span class=rvts64>KEY </span><span class=rvts63>(</span><span class=rvts61>col1</span><span class=rvts63>),</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- each constraint must have a name and can reference multiple columns at once</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>CONSTRAINT</span><span class=rvts61> UNIQUE_mt_3 </span><span class=rvts64>UNIQUE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts63>(</span><span class=rvts61>col2</span><span class=rvts63>),</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>CONSTRAINT</span><span class=rvts61> CHECK_mt_3&nbsp; </span><span class=rvts64>CHECK&nbsp;&nbsp; </span><span class=rvts63>(</span><span class=rvts61>0 </span><span class=rvts63>&lt;</span><span class=rvts61> col3</span><span class=rvts63>),</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>CONSTRAINT</span><span class=rvts61> FK_mt_3&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>FOREIGN</span><span class=rvts61> </span><span class=rvts64>KEY </span><span class=rvts63>(</span><span class=rvts61>col4</span><span class=rvts63>)</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- the ON {UPDATE|DELETE} specifies what happens if the parent record is update/deleted:</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>REFERENCES</span><span class=rvts61> my_parent_table</span><span class=rvts63>(</span><span class=rvts61>col1</span><span class=rvts63>)</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- NO ACTION:&nbsp;&nbsp; the update/delete statement is rejected and fails</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>ON</span><span class=rvts61> </span><span class=rvts64>DELETE</span><span class=rvts61> </span><span class=rvts64>NO</span><span class=rvts61> </span><span class=rvts64>ACTION</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- CASCADE:&nbsp;&nbsp;&nbsp;&nbsp; changes to the parent table are propagated to the child</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>ON</span><span class=rvts61> </span><span class=rvts67>UPDATE</span><span class=rvts61> </span><span class=rvts64>CASCADE</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- SET NULL:&nbsp;&nbsp;&nbsp; if the parent record changes or is deleted, the child's reference is set to NULL</span></p>
<p><span class=rvts63>);</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- SET DEFAULT: if the parent record changes or is deleted, the child's reference is reset to its default value</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>CREATE</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> #my_local_temp_table (...)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- tables with names starting with "#" exists only within the current session (and are deleted automaticall)</span></p>
<p><span class=rvts64>CREATE</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> ##my_global_temp_table (...)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- tables with names starting with "##" are temporary objects but visible to all users</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>ALTER</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table </span><span class=rvts64>ADD</span><span class=rvts61> col2 </span><span class=rvts64>INT</span><span class=rvts61> </span><span class=rvts63>NULL;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- add a column to an existing table</span></p>
<p><span class=rvts64>ALTER</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table </span><span class=rvts64>DROP</span><span class=rvts61> </span><span class=rvts64>COLUMN</span><span class=rvts61> col2</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- remove a column from a table</span></p>
<p><span class=rvts64>ALTER</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table </span><span class=rvts64>ALTER</span><span class=rvts61> </span><span class=rvts64>COLUMN</span><span class=rvts61> col2 </span><span class=rvts64>INT</span><span class=rvts61> </span><span class=rvts63>NULL;</span><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- alter an existing column (can change only the data type and the NULL property)</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>ALTER</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table </span><span class=rvts64>ADD</span><span class=rvts61> </span><span class=rvts64>CONSTRAINT</span><span class=rvts61> c </span><span class=rvts64>UNIQUE</span><span class=rvts63>(</span><span class=rvts61>col2</span><span class=rvts63>);</span><span class=rvts61> </span><span class=rvts62>-- add a new constraint to an existing table</span></p>
<p><span class=rvts64>ALTER</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table </span><span class=rvts64>DROP</span><span class=rvts61> </span><span class=rvts64>CONSTRAINT</span><span class=rvts61> c</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- remove an existing constraint</span></p>
<p><span class=rvts64>ALTER</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table </span><span class=rvts64>NOCHECK</span><span class=rvts61> </span><span class=rvts64>CONSTRAINT</span><span class=rvts61> c</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- disable a constraint (pass ALL as the constraint name to disable all)</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>EXEC</span><span class=rvts61> </span><span class=rvts65>sp_rename</span><span class=rvts64> </span><span class=rvts61>@objname</span><span class=rvts63>=</span><span class=rvts61>my_table</span><span class=rvts63>,</span><span class=rvts61> @newname</span><span class=rvts63>=</span><span class=rvts61>table_2</span><span class=rvts63>;</span><span class=rvts61> </span><span class=rvts62>-- rename a database object (applicable to all kinds of objects, not only tables)</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>EXEC</span><span class=rvts61> </span><span class=rvts65>sp_rename</span><span class=rvts64> </span><span class=rvts61>@objname</span><span class=rvts63>=</span><span class=rvts66>'my_table.col1'</span><span class=rvts63>,</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- rename a table column</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @newname</span><span class=rvts63>=</span><span class=rvts61>col2</span><span class=rvts63>;</span><span class=rvts61> </span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>DROP</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- remove an existing table with indices and constraints (dependent views are preserved)</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts9><br></span></p>
<div id='nodeSection2'>Auto-historicised tables (SQL Server 2016)</div>
<p><span class=rvts12><br></span></p>
<p><span class=rvts64>CREATE</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- create a table that automatically archives superseded records</span></p>
<p><span class=rvts63>(</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; id </span><span class=rvts64>INT</span><span class=rvts61> </span><span class=rvts64>IDENTITY</span><span class=rvts61> </span><span class=rvts63>NOT</span><span class=rvts61> </span><span class=rvts63>NULL</span><span class=rvts61> </span><span class=rvts64>PRIMARY</span><span class=rvts61> </span><span class=rvts64>KEY</span><span class=rvts63>,</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; data </span><span class=rvts64>NVARCHAR</span><span class=rvts63>(</span><span class=rvts61>100</span><span class=rvts63>),</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>start_date</span><span class=rvts61> </span><span class=rvts64>DATETIME2</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- the start and end date are auto-generated and hidden fields</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GENERATED ALWAYS </span><span class=rvts64>AS</span><span class=rvts61> </span><span class=rvts64>ROW</span><span class=rvts61> START HIDDEN</span><span class=rvts63>,</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- (they don't show up on SELECT * but can be selected explicitely)</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; end_date </span><span class=rvts64>DATETIME2</span><span class=rvts61> </span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GENERATED ALWAYS </span><span class=rvts64>AS</span><span class=rvts61> </span><span class=rvts64>ROW</span><span class=rvts61> </span><span class=rvts64>END</span><span class=rvts61> HIDDEN</span><span class=rvts63>,</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; PERIOD </span><span class=rvts64>FOR</span><span class=rvts61> </span><span class=rvts64>SYSTEM</span><span class=rvts61> </span><span class=rvts64>TIME </span><span class=rvts63>(</span><span class=rvts64>start_date</span><span class=rvts63>,</span><span class=rvts61> end_date</span><span class=rvts63>)</span><span class=rvts61>&nbsp;&nbsp; </span><span class=rvts62>-- specifiy which fields constitute the record's validity period</span></p>
<p><span class=rvts63>)</span></p>
<p><span class=rvts64>WITH</span><span class=rvts61> SYSTEM_VERSIONING</span><span class=rvts63>=</span><span class=rvts64>ON</span><span class=rvts63>(</span><span class=rvts61>HISTORY_TABLE</span><span class=rvts63>=</span><span class=rvts61>my_archive</span><span class=rvts63>);</span><span class=rvts62>-- move deleted and overwritten/updated records to this archive table</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>SELECT</span><span class=rvts61> </span><span class=rvts63>*</span><span class=rvts61> </span><span class=rvts64>FROM</span><span class=rvts61> my_table </span><span class=rvts64>FOR</span><span class=rvts61> </span><span class=rvts64>SYSTEM</span><span class=rvts61> </span><span class=rvts64>TIME</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- select records that ...</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>AS</span><span class=rvts61> </span><span class=rvts64>OF</span><span class=rvts61> </span><span class=rvts66>'2016-11-29 13:00:00'</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- were current at the given date and time, or</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>FROM</span><span class=rvts61> </span><span class=rvts66>'2016-...'</span><span class=rvts61> </span><span class=rvts64>TO</span><span class=rvts61> </span><span class=rvts66>'2016-...'</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- somehow overlap with (or are contained in) specified time perios</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts63>BETWEEN</span><span class=rvts61> </span><span class=rvts66>'2016-...'</span><span class=rvts61> </span><span class=rvts63>AND</span><span class=rvts61> </span><span class=rvts66>'2016-...'</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; CONTAINED </span><span class=rvts63>IN(</span><span class=rvts66>'2016-...'</span><span class=rvts63>,</span><span class=rvts61> </span><span class=rvts66>'2016-...'</span><span class=rvts63>)</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts63>ALL</span></p>
<p><span class=rvts63><br></span></p>
<p><span class=rvts9><br></span></p>
<div id='nodeSection3'>Pinned tables</div>
<p><span class=rvts12><br></span></p>
<p><span class=rvts64>DBCC</span><span class=rvts61> PINTABLE</span><span class=rvts63>(</span><span class=rvts67>DB_ID</span><span class=rvts63>(</span><span class=rvts66>'db'</span><span class=rvts63>),</span><span class=rvts61> </span><span class=rvts67>OBJECT_ID</span><span class=rvts63>(</span><span class=rvts66>'table'</span><span class=rvts63>))</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- activate caching for a given table or view (all read records are cached in memory)</span></p>
<p><span class=rvts64>DBCC</span><span class=rvts61> UNPINTABLE</span><span class=rvts63>(</span><span class=rvts67>DB_ID</span><span class=rvts63>(</span><span class=rvts66>'db'</span><span class=rvts63>),</span><span class=rvts61> </span><span class=rvts67>OBJECT_ID</span><span class=rvts63>(</span><span class=rvts66>'table'</span><span class=rvts63>))</span><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- deactivate caching for a given table</span></p>
<p><span class=rvts62><br></span></p>
<p><span class=rvts9><br></span></p>
<div id='nodeSection4'>Memory-optimised tables (SQL Server 2016)</div>
<p><span class=rvts12><br></span></p>
<p><span class=rvts64>ALTER</span><span class=rvts61> </span><span class=rvts64>DATABASE</span><span class=rvts61> my_database&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>ADD</span><span class=rvts61> </span><span class=rvts64>FILEGROUP</span><span class=rvts61> my_file_group&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- add a new filegroup for memory-optimised tables</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts67>CONTAINS</span><span class=rvts61> MEMORY_OPTIMIZED_DATA</span><span class=rvts63>;</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- (each database can have only one such filegroup)</span></p>
<p><span class=rvts61><br></span></p>
<p><span class=rvts64>ALTER</span><span class=rvts61> </span><span class=rvts64>DATABASE</span><span class=rvts61> my_database </span><span class=rvts64>ADD</span><span class=rvts61> </span><span class=rvts64>FILE</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- add files to the filegroup</span></p>
<p><span class=rvts63>(</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; NAME </span><span class=rvts63>=</span><span class=rvts61> my_file_group</span><span class=rvts63>,</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>FILENAME</span><span class=rvts61> </span><span class=rvts63>=</span><span class=rvts61> </span><span class=rvts66>'C:\temp\FileStream'</span></p>
<p><span class=rvts63>)</span></p>
<p><span class=rvts64>TO</span><span class=rvts61> </span><span class=rvts64>FILEGROUP</span><span class=rvts61> my_file_group</span><span class=rvts63>;</span></p>
<p><span class=rvts63><br></span></p>
<p><span class=rvts64>CREATE</span><span class=rvts61> </span><span class=rvts64>TABLE</span><span class=rvts61> my_table</span><span class=rvts64> </span><span class=rvts63>(</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- some column types (large objects, max, XML) are not allowed, the maximum record length is 8060 bytes</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts63>...,</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>PRIMARY</span><span class=rvts61> </span><span class=rvts64>KEY</span><span class=rvts61> </span><span class=rvts64>NONCLUSTERED</span><span class=rvts61> </span><span class=rvts64>HASH</span><span class=rvts63>(</span><span class=rvts61>col1</span><span class=rvts63>,</span><span class=rvts61> col2</span><span class=rvts63>,</span><span class=rvts61> </span><span class=rvts63>...)</span><span class=rvts61>&nbsp; </span><span class=rvts62>-- memory-otpimised tables suppored hash indices (correspond to clustered indices of regular tables)</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>WITH </span><span class=rvts63>(</span><span class=rvts64>BUCKET_COUNT</span><span class=rvts61> </span><span class=rvts63>=</span><span class=rvts61> 1000</span><span class=rvts63>),</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- bucket size of the hash index (should be at least the number of unique values in the hash index)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp; </span><span class=rvts64>INDEX</span><span class=rvts61> my_index </span><span class=rvts64>NONCLUSTERED </span><span class=rvts63>(</span><span class=rvts61>col1</span><span class=rvts63>,</span><span class=rvts61> col2</span><span class=rvts63>,</span><span class=rvts61> </span><span class=rvts63>...)</span><span class=rvts61>&nbsp;&nbsp; </span><span class=rvts62>-- all indexes must be added when creating a table (CREATE INDEX is not supported for memory-optimized tables)</span></p>
<p><span class=rvts63>)</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p><span class=rvts64>WITH </span><span class=rvts63>(</span><span class=rvts64>MEMORY_OPTIMIZED</span><span class=rvts61> </span><span class=rvts63>=</span><span class=rvts61> </span><span class=rvts64>ON</span><span class=rvts63>,</span><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts62>-- mark the table as memory-optimised</span></p>
<p><span class=rvts61>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=rvts64>DURABILITY</span><span class=rvts61> </span><span class=rvts63>=</span><span class=rvts61> </span><span class=rvts63>{</span><span class=rvts61>SCHEMA_AND_DATA</span><span class=rvts63>|</span><span class=rvts61>SCHEMA_ONLY</span><span class=rvts63>});</span><span class=rvts61>&nbsp; </span><span class=rvts62>-- with SCHEMA_ONLY updates are not written back to disk</span></p>
<p><span class=rvts61><br></span></p>
<p><br></p>
<p><br></p>

